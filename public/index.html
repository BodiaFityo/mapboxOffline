<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Display buildings in 3D</title>
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css"
      rel="stylesheet"
    />
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <script src="https://unpkg.com/three@0.126.0/build/three.min.js"></script>
    <script src="https://unpkg.com/three@0.126.0/examples/js/loaders/GLTFLoader.js"></script>
    <div id="map"></div>
    <script>
      mapboxgl.accessToken = "NOT-REQUIRED-WITH-YOUR-VECTOR-TILES-DATA";
      const map = new mapboxgl.Map({
        style: {
          version: 8,
          sources: {
            "custom-tiles": {
              type: "vector",
              tiles: ["http://localhost:8080/data/v3/{z}/{x}/{y}.pbf"],
              minzoom: 0,
              maxzoom: 14,
            },
          },
          layers: [
            {
              id: "background",
              type: "background",
              paint: {
                "background-color": "#8b8b8b",
              },
            },
            {
              id: "country-glow-inner",
              type: "line",
              source: "custom-tiles",
              "source-layer": "boundary",
              layout: {
                "line-join": "round",
              },
              paint: {
                "line-emissive-strength": 1,
                "line-color": "#80cbc4",
                "line-width": [
                  "interpolate",
                  ["linear"],
                  ["zoom"],
                  3,
                  0.5,
                  12,
                  2,
                ],
                "line-dasharray": [10, 0],
              },

              // rainbow start
            },
            {
              id: "building",
              type: "fill-extrusion",
              source: "custom-tiles",
              "source-layer": "building",
              paint: {
                "fill-extrusion-color": [
                  "case",
                  ["boolean", ["get", "hide_3d"], true],
                  "transparent",
                  ["get", "colour"],
                ],
                "fill-extrusion-height": ["get", "render_height"],
                "fill-extrusion-base": ["get", "render_min_height"],
                "fill-extrusion-opacity": 0.6,
              },
              minzoom: 13,
              maxzoom: 20,
            },
            {
              filter: [
                "all",
                ["==", "$type", "LineString"],
                ["==", "brunnel", "tunnel"],
                ["==", "class", "transit"],
              ],
              id: "tunnel_railway_transit",
              layout: {
                "line-cap": "butt",
                "line-join": "miter",
              },
              minzoom: 0,
              paint: {
                "line-color": "hsl(34, 12%, 66%)",
                "line-dasharray": [3, 3],
                "line-opacity": {
                  base: 1,
                  stops: [
                    [11, 0],
                    [16, 1],
                  ],
                },
              },
              source: "custom-tiles",
              "source-layer": "transportation",
              type: "line",
            },
            {
              filter: [
                "all",
                ["==", "class", "transit"],
                ["!=", "brunnel", "tunnel"],
              ],
              id: "railway-transit",
              paint: {
                "line-color": "hsl(34, 12%, 66%)",
                "line-opacity": {
                  base: 1,
                  stops: [
                    [11, 0],
                    [16, 1],
                  ],
                },
              },
              source: "custom-tiles",
              "source-layer": "transportation",
              type: "line",
            },
            {
              filter: ["==", "class", "rail"],
              id: "railway",
              paint: {
                "line-color": "hsl(34, 12%, 66%)",
                "line-opacity": {
                  base: 1,
                  stops: [
                    [11, 0],
                    [16, 1],
                  ],
                },
              },
              source: "custom-tiles",
              "source-layer": "transportation",
              type: "line",
            },
            {
              filter: ["==", "subclass", "ice_shelf"],
              id: "landcover-ice-shelf",
              paint: {
                "fill-color": "hsl(47, 26%, 88%)",
                "fill-opacity": 0.8,
              },
              source: "custom-tiles",
              "source-layer": "landcover",
              type: "fill",
            },

            {
              filter: ["==", "subclass", "glacier"],
              id: "landcover-glacier",
              paint: {
                "fill-color": "hsl(47, 22%, 94%)",
                "fill-opacity": {
                  base: 1,
                  stops: [
                    [0, 1],
                    [8, 0.5],
                  ],
                },
              },
              source: "custom-tiles",
              "source-layer": "landcover",
              type: "fill",
            },
            {
              filter: ["all", ["in", "class", "sand"]],
              id: "landcover_sand",
              metadata: {},
              paint: {
                "fill-antialias": false,
                "fill-color": "rgba(232, 214, 38, 1)",
                "fill-opacity": 0.3,
              },
              source: "custom-tiles",
              "source-layer": "landcover",
              type: "fill",
            },
            // {
            //   id: "landcover",
            //   type: "fill",
            //   source: "custom-tiles",
            //   "source-layer": "landcover",
            //   paint: {
            //     "fill-color": [
            //       "match",
            //       ["get", "class"],
            //       "water",
            //       "blue",
            //       "forest",
            //       "green",
            //       "urban",
            //       "gray",
            //       /* Add more class-color pairs as needed */
            //       "transparent" /* Default color */,
            //     ],
            //     "fill-opacity": 0.7,
            //   },
            //   minzoom: 7,
            //   maxzoom: 14,
            // },

            // {
            //   id: "landuse",
            //   type: "fill",
            //   source: "custom-tiles",
            //   "source-layer": "landuse",
            //   minzoom: 5,
            //   filter: [
            //     "all",
            //     ["\u003E=", ["to-number", ["get", "sizerank"]], 0],
            //     [
            //       "match",
            //       ["get", "class"],
            //       [
            //         "agriculture",
            //         "wood",
            //         "grass",
            //         "scrub",
            //         "park",
            //         "airport",
            //         "glacier",
            //         "pitch",
            //         "sand",
            //       ],
            //       true,
            //       "residential",
            //       ["step", ["zoom"], true, 12, false],
            //       ["facility", "industrial"],
            //       ["step", ["zoom"], false, 12, true],
            //       "cemetery",
            //       true,
            //       "school",
            //       true,
            //       "hospital",
            //       true,
            //       "commercial_area",
            //       true,
            //       false,
            //     ],
            //     [
            //       "\u003C=",
            //       [
            //         "-",
            //         ["to-number", ["get", "sizerank"]],
            //         [
            //           "interpolate",
            //           ["exponential", 1.5],
            //           ["zoom"],
            //           12,
            //           0,
            //           18,
            //           14,
            //         ],
            //       ],
            //       14,
            //     ],
            //   ],
            //   layout: {},
            //   paint: {
            //     "fill-emissive-strength": 0.25,
            //     "fill-color": [
            //       "interpolate",
            //       ["linear"],
            //       ["measure-light", "brightness"],
            //       0.1,
            //       [
            //         "match",
            //         ["get", "class"],
            //         "wood",
            //         "hsla(115, 55%, 74%, 0.8)",
            //         "scrub",
            //         "hsla(110, 52%, 82%, 0.6)",
            //         "agriculture",
            //         "hsla(110, 55%, 88%, 0.6)",
            //         "park",
            //         "hsl(110, 60%, 80%)",
            //         "grass",
            //         "hsla(110, 55%, 88%, 0.6)",
            //         "airport",
            //         "hsl(225, 35%, 70%)",
            //         "cemetery",
            //         "hsl(110, 30%, 75%)",
            //         "glacier",
            //         "hsl(200, 70%, 95%)",
            //         "hospital",
            //         "hsl(0, 30%, 70%)",
            //         "pitch",
            //         "hsl(100, 70%, 80%)",
            //         "sand",
            //         "hsl(52, 65%, 75%)",
            //         "school",
            //         "hsl(40, 10%, 60%)",
            //         "commercial_area",
            //         "hsl(324, 27%, 70%)",
            //         "residential",
            //         "hsl(20, 7%, 97%)",
            //         ["facility", "industrial"],
            //         "hsl(230, 20%, 70%)",
            //         "hsl(20, 22%, 86%)",
            //       ],
            //       0.4,
            //       [
            //         "match",
            //         ["get", "class"],
            //         "wood",
            //         "hsla(115, 55%, 74%, 0.8)",
            //         "scrub",
            //         "hsla(110, 52%, 82%, 0.6)",
            //         "agriculture",
            //         "hsla(110, 55%, 88%, 0.6)",
            //         "park",
            //         "hsl(110, 60%, 80%)",
            //         "grass",
            //         "hsla(110, 55%, 88%, 0.6)",
            //         "airport",
            //         "hsl(225, 60%, 92%)",
            //         "cemetery",
            //         "hsl(110, 48%, 85%)",
            //         "glacier",
            //         "hsl(200, 70%, 90%)",
            //         "hospital",
            //         "hsl(0, 50%, 92%)",
            //         "pitch",
            //         "hsl(100, 70%, 85%)",
            //         "sand",
            //         "hsl(52, 65%, 86%)",
            //         "school",
            //         "hsl(40, 50%, 88%)",
            //         "commercial_area",
            //         "hsl(24, 100%, 94%)",
            //         "residential",
            //         "hsl(20, 7%, 97%)",
            //         ["facility", "industrial"],
            //         "hsl(230, 20%, 90%)",
            //         "hsl(20, 22%, 86%)",
            //       ],
            //     ],
            //     "fill-opacity": [
            //       "interpolate",
            //       ["linear"],
            //       ["zoom"],
            //       5,
            //       0,
            //       6,
            //       [
            //         "match",
            //         ["get", "class"],
            //         ["residential", "airport"],
            //         0.8,
            //         0.2,
            //       ],
            //       10,
            //       [
            //         "match",
            //         ["get", "class"],
            //         ["residential"],
            //         0,
            //         ["grass", "scrub", "glacier", "pitch", "sand", "airport"],
            //         1,
            //         [
            //           "interpolate",
            //           ["linear"],
            //           ["measure-light", "brightness"],
            //           0.1,
            //           0.8,
            //           0.4,
            //           1,
            //         ],
            //       ],
            //     ],
            //     "fill-outline-color": "hsla(0, 0%, 0%,0)",
            //   },
            // },

            {
              id: "park",
              type: "fill",
              source: "custom-tiles",
              "source-layer": "park",
              paint: {
                "fill-color": "green" /* You can adjust the color here */,
                "fill-opacity": 0.5,
              },
              minzoom: 4,
              maxzoom: 20,
            },
            {
              filter: [
                "all",
                ["==", "$type", "Polygon"],
                ["!=", "intermittent", 1],
              ],
              id: "water",
              paint: {
                "fill-color": "hsl(205, 56%, 73%)",
              },
              source: "custom-tiles",
              "source-layer": "water",
              type: "fill",
            },
            {
              id: "waterway",
              type: "line",
              source: "custom-tiles",
              "source-layer": "waterway",
              paint: {
                "line-color": "#80cbc4" /* You can adjust the color here */,
                "line-width": 2,
              },
              minzoom: 0,
              maxzoom: 20,
            },
            {
              id: "transportation",
              type: "line",
              source: "custom-tiles",
              "source-layer": "transportation",
              paint: {
                "line-color": "#424242" /* Adjust the color here */,
                "line-width": 2,
              },
              minzoom: 0,
              maxzoom: 20,
            },

            {
              filter: [
                "all",
                ["==", "$type", "LineString"],
                ["in", "class", "path", "track"],
              ],
              id: "road_path",
              layout: {
                "line-cap": "square",
                "line-join": "bevel",
              },
              paint: {
                "line-color": "hsl(0, 0%, 97%)",
                "line-dasharray": [1, 1],
                "line-width": {
                  base: 1.55,
                  stops: [
                    [4, 0.25],
                    [20, 10],
                  ],
                },
              },
              source: "custom-tiles",
              "source-layer": "transportation",
              type: "line",
            },

            {
              id: "custom-tiles",
              type: "fill",
              source: "custom-tiles",
              "source-layer": "custom-tile", // Specify your source layer here if applicable
              paint: {
                // Add your basic styles here
                "fill-color": "#ff0000", // Not need?
              },
            },
          ],
        },
        center: [12.564834208211984, 55.672547203742845],
        zoom: 15,
        pitch: 45,
        bearing: -17.6,
        container: "map",
      });

      map.on("style.load", () => {
        // Insert the layer beneath any symbol layer.
        const layers = map.getStyle().layers;
      });
    </script>
  </body>
</html>
